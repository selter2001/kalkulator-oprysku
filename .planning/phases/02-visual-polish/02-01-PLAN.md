---
phase: 02-visual-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - SprayCalculator/Assets.xcassets/Colors/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/primaryGreen.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/lightGreen.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/darkGreen.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/earthBrown.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/lightBrown.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/darkBrown.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/accentGold.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/waterBlue.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/errorRed.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/backgroundPrimary.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/backgroundCard.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/backgroundSecondary.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/textPrimary.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/textSecondary.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/gradientStart.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/gradientEnd.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/backgroundGradientStart.colorset/Contents.json
  - SprayCalculator/Assets.xcassets/Colors/backgroundGradientEnd.colorset/Contents.json
  - SprayCalculator/Theme/AppGradients.swift
  - SprayCalculator/Components.swift
  - SprayCalculator.xcodeproj/project.pbxproj
autonomous: true

must_haves:
  truths:
    - "18 named color sets exist in Assets.xcassets/Colors with both light and dark mode variants"
    - "AppGradients provides adaptive gradient definitions using Asset Catalog colors"
    - "Components.swift (SprayInputField, ResultCard, PrimaryButton, SecondaryButton, SectionHeader) uses Color(.name) syntax, semantic fonts, and @ScaledMetric for non-text dimensions"
    - "No hardcoded Color(red:green:blue:) or .system(size:) font literals remain in Components.swift"
  artifacts:
    - path: "SprayCalculator/Assets.xcassets/Colors/primaryGreen.colorset/Contents.json"
      provides: "Adaptive primaryGreen color (light + dark)"
      contains: "\"appearance\": \"luminosity\""
    - path: "SprayCalculator/Theme/AppGradients.swift"
      provides: "Adaptive gradient definitions"
      contains: "AppGradients"
    - path: "SprayCalculator/Components.swift"
      provides: "Migrated reusable UI components with semantic colors and fonts"
      contains: "@ScaledMetric"
  key_links:
    - from: "SprayCalculator/Components.swift"
      to: "SprayCalculator/Assets.xcassets/Colors/"
      via: "Color(.primaryGreen) type-safe resource references"
      pattern: "Color\\(\\.\\w+\\)"
    - from: "SprayCalculator/Theme/AppGradients.swift"
      to: "SprayCalculator/Assets.xcassets/Colors/"
      via: "Color(.gradientStart) etc. in gradient definitions"
      pattern: "Color\\(\\.\\w+\\)"
---

<objective>
Create the complete Asset Catalog color system with light/dark variants for all 18 semantic colors, build the AppGradients theme layer for adaptive gradients, and migrate Components.swift (the heaviest view file with 14 color refs and 7 hardcoded fonts) to the new system with @ScaledMetric support.

Purpose: Establishes the color foundation that all other views will reference. Components.swift is migrated first because it defines SprayInputField, ResultCard, PrimaryButton, SecondaryButton, and SectionHeader -- the reusable building blocks used across every screen.

Output: 18 colorset JSON files, AppGradients.swift, fully migrated Components.swift with zero hardcoded colors or fonts.
</objective>

<execution_context>
@/Users/wojciecholszak/.claude/get-shit-done/workflows/execute-plan.md
@/Users/wojciecholszak/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-visual-polish/02-RESEARCH.md
@SprayCalculator/Colors.swift
@SprayCalculator/Components.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Asset Catalog color sets with light/dark variants and AppGradients.swift</name>
  <files>
    SprayCalculator/Assets.xcassets/Colors/Contents.json
    SprayCalculator/Assets.xcassets/Colors/primaryGreen.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/lightGreen.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/darkGreen.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/earthBrown.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/lightBrown.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/darkBrown.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/accentGold.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/waterBlue.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/errorRed.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/backgroundPrimary.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/backgroundCard.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/backgroundSecondary.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/textPrimary.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/textSecondary.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/gradientStart.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/gradientEnd.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/backgroundGradientStart.colorset/Contents.json
    SprayCalculator/Assets.xcassets/Colors/backgroundGradientEnd.colorset/Contents.json
    SprayCalculator/Theme/AppGradients.swift
    SprayCalculator.xcodeproj/project.pbxproj
  </files>
  <action>
    **Step 1: Create Colors subfolder in Assets.xcassets**

    Create `SprayCalculator/Assets.xcassets/Colors/Contents.json` with `provides-namespace: false` so colors are accessed as `Color(.primaryGreen)` not `Color(.Colors.primaryGreen)`:

    ```json
    {
      "info": { "author": "xcode", "version": 1 },
      "properties": { "provides-namespace": false }
    }
    ```

    **Step 2: Create 18 colorset directories, each with Contents.json**

    Every colorset follows the same JSON structure with universal (light) + dark appearance. Use the exact RGB values from the research (02-RESEARCH.md "Current Color Inventory" table):

    | colorset name | Light RGB | Dark RGB |
    |---|---|---|
    | primaryGreen | (0.18, 0.54, 0.34) | (0.30, 0.68, 0.42) |
    | lightGreen | (0.40, 0.73, 0.42) | (0.45, 0.78, 0.48) |
    | darkGreen | (0.10, 0.36, 0.22) | (0.20, 0.52, 0.32) |
    | earthBrown | (0.55, 0.38, 0.24) | (0.65, 0.50, 0.35) |
    | lightBrown | (0.76, 0.60, 0.42) | (0.55, 0.42, 0.28) |
    | darkBrown | (0.36, 0.25, 0.15) | (0.50, 0.38, 0.25) |
    | accentGold | (0.85, 0.65, 0.13) | (0.90, 0.72, 0.20) |
    | waterBlue | (0.25, 0.61, 0.76) | (0.35, 0.70, 0.85) |
    | errorRed | (0.85, 0.30, 0.25) | (0.95, 0.40, 0.35) |
    | backgroundPrimary | (0.96, 0.95, 0.92) | (0.12, 0.14, 0.13) |
    | backgroundCard | (1.0, 1.0, 1.0) | (0.18, 0.20, 0.19) |
    | backgroundSecondary | (0.92, 0.90, 0.85) | (0.14, 0.16, 0.15) |
    | textPrimary | (0.15, 0.15, 0.14) | (0.95, 0.95, 0.93) |
    | textSecondary | (0.45, 0.45, 0.43) | (0.70, 0.70, 0.68) |
    | gradientStart | (0.18, 0.54, 0.34) | (0.30, 0.68, 0.42) |
    | gradientEnd | (0.10, 0.36, 0.22) | (0.20, 0.52, 0.32) |
    | backgroundGradientStart | (0.96, 0.95, 0.92) | (0.12, 0.14, 0.13) |
    | backgroundGradientEnd | (0.92, 0.90, 0.85) | (0.10, 0.12, 0.11) |

    Each Contents.json follows this template (example for primaryGreen):
    ```json
    {
      "colors": [
        {
          "color": {
            "color-space": "srgb",
            "components": { "alpha": "1.000", "red": "0.180", "green": "0.540", "blue": "0.340" }
          },
          "idiom": "universal"
        },
        {
          "appearances": [{ "appearance": "luminosity", "value": "dark" }],
          "color": {
            "color-space": "srgb",
            "components": { "alpha": "1.000", "red": "0.300", "green": "0.680", "blue": "0.420" }
          },
          "idiom": "universal"
        }
      ],
      "info": { "author": "xcode", "version": 1 }
    }
    ```

    **Step 3: Create AppGradients.swift in new Theme/ directory**

    Create `SprayCalculator/Theme/AppGradients.swift`:

    ```swift
    import SwiftUI

    // MARK: - Adaptive Gradients
    // Colors adapt automatically via Asset Catalog light/dark variants.
    // Use @Environment(\.colorScheme) only if gradient STRUCTURE needs to change between modes.
    enum AppGradients {
        static var primaryGradient: LinearGradient {
            LinearGradient(
                colors: [Color(.gradientStart), Color(.gradientEnd)],
                startPoint: .topLeading,
                endPoint: .bottomTrailing
            )
        }

        static var backgroundGradient: LinearGradient {
            LinearGradient(
                colors: [Color(.backgroundGradientStart), Color(.backgroundGradientEnd)],
                startPoint: .top,
                endPoint: .bottom
            )
        }

        static var earthGradient: LinearGradient {
            LinearGradient(
                colors: [Color(.lightBrown), Color(.earthBrown)],
                startPoint: .top,
                endPoint: .bottom
            )
        }
    }
    ```

    **Step 4: Add AppGradients.swift to Xcode project**

    Add `SprayCalculator/Theme/AppGradients.swift` to the Xcode project's `project.pbxproj`. Follow the same pattern used when adding `CalcViewModel.swift` in Phase 1 (01-02-SUMMARY): create a PBXFileReference, add to PBXBuildFile, add to the Sources build phase, and create a PBXGroup for the Theme folder. Look at how `SprayCalculator/Services/SprayCalculatorService.swift` was added and follow the exact same pattern for the Theme group.
  </action>
  <verify>
    1. Count colorset directories: `ls SprayCalculator/Assets.xcassets/Colors/*.colorset | wc -l` should output 18
    2. Each Contents.json is valid JSON: `for f in SprayCalculator/Assets.xcassets/Colors/*.colorset/Contents.json; do python3 -m json.tool "$f" > /dev/null && echo "OK: $f" || echo "FAIL: $f"; done`
    3. Every colorset has a dark appearance entry: `grep -l "luminosity" SprayCalculator/Assets.xcassets/Colors/*.colorset/Contents.json | wc -l` should output 18
    4. AppGradients.swift exists and references Color(.name) pattern: `grep -c 'Color(\.' SprayCalculator/Theme/AppGradients.swift` should be >= 6
    5. AppGradients.swift appears in pbxproj: `grep -c "AppGradients.swift" SprayCalculator.xcodeproj/project.pbxproj` should be >= 1
  </verify>
  <done>
    18 colorset directories exist under Assets.xcassets/Colors/, each with a valid Contents.json containing both universal (light) and dark appearance color definitions. AppGradients.swift exists in SprayCalculator/Theme/ providing 3 adaptive gradient definitions using Color(.name) syntax. The file is registered in the Xcode project.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate Components.swift to semantic colors, fonts, and @ScaledMetric</name>
  <files>SprayCalculator/Components.swift</files>
  <action>
    Replace ALL hardcoded colors and fonts in Components.swift. This file has 5 view structs: SprayInputField, ResultCard, PrimaryButton, SecondaryButton, SectionHeader.

    **Color replacements** (apply throughout the file):
    - `.foregroundColor(.textSecondary)` → `.foregroundStyle(Color(.textSecondary))`
    - `.foregroundColor(.primaryGreen)` → `.foregroundStyle(Color(.primaryGreen))`
    - `.foregroundColor(.textPrimary)` → `.foregroundStyle(Color(.textPrimary))`
    - `.foregroundColor(.white)` → `.foregroundStyle(.white)` (keep white -- it's on green gradient background)
    - `Color.backgroundLight` → `Color(.backgroundSecondary)` (unit capsule fill)
    - `Color.backgroundCard` → `Color(.backgroundCard)`
    - `Color.primaryGreen.opacity(0.2)` → `Color(.primaryGreen).opacity(0.2)`
    - `Color.primaryGreen` → `Color(.primaryGreen)` (stroke, capsule stroke)
    - `Color.black.opacity(0.05)` → `Color(.textPrimary).opacity(0.05)` (shadow adapts)
    - `Color.black.opacity(0.08)` → `Color(.textPrimary).opacity(0.08)` (shadow adapts)
    - `LinearGradient.primaryGradient` → `AppGradients.primaryGradient`
    - `Color.primaryGreen.opacity(0.4)` → `Color(.primaryGreen).opacity(0.4)` (button shadow)

    **Font replacements:**

    SprayInputField:
    - Icon `.font(.system(size: 18, weight: .medium))` → `.font(.body.weight(.medium))`
    - TextField `.font(.system(size: 18, weight: .semibold, design: .rounded))` → `.font(.body.weight(.semibold))` then add `.fontDesign(.rounded)`

    ResultCard:
    - Emoji `.font(.system(size: 24))` → `.font(.title3)`
    - Value `.font(.system(size: 28, weight: .bold, design: .rounded))` → `.font(.title2.weight(.bold))` then add `.fontDesign(.rounded)`

    PrimaryButton:
    - Icon `.font(.system(size: 18, weight: .semibold))` → `.font(.body.weight(.semibold))`
    - Title `.font(.system(size: 18, weight: .bold, design: .rounded))` → `.font(.body.weight(.bold))` then add `.fontDesign(.rounded)`

    SecondaryButton:
    - Icon `.font(.system(size: 14, weight: .semibold))` → `.font(.subheadline.weight(.semibold))`
    - Title `.font(.system(size: 14, weight: .semibold, design: .rounded))` → `.font(.subheadline.weight(.semibold))` then add `.fontDesign(.rounded)`

    SectionHeader:
    - Icon `.font(.system(size: 16, weight: .semibold))` → `.font(.subheadline.weight(.semibold))`
    - Title `.font(.system(size: 18, weight: .bold, design: .rounded))` → `.font(.headline)` then add `.fontDesign(.rounded)`

    **@ScaledMetric additions:**

    Add to SprayInputField:
    ```swift
    @ScaledMetric(relativeTo: .body) private var iconWidth: CGFloat = 24
    @ScaledMetric(relativeTo: .body) private var horizontalPadding: CGFloat = 16
    @ScaledMetric(relativeTo: .body) private var verticalPadding: CGFloat = 14
    @ScaledMetric(relativeTo: .caption) private var unitPaddingH: CGFloat = 10
    @ScaledMetric(relativeTo: .caption) private var unitPaddingV: CGFloat = 6
    ```
    Then replace `.frame(width: 24)` with `.frame(width: iconWidth)`, `.padding(.horizontal, 16)` with `.padding(.horizontal, horizontalPadding)`, `.padding(.vertical, 14)` with `.padding(.vertical, verticalPadding)`, `.padding(.horizontal, 10)` with `.padding(.horizontal, unitPaddingH)`, `.padding(.vertical, 6)` with `.padding(.vertical, unitPaddingV)`.

    Add to ResultCard:
    ```swift
    @ScaledMetric(relativeTo: .title2) private var iconCircleSize: CGFloat = 50
    @ScaledMetric(relativeTo: .body) private var cardPadding: CGFloat = 16
    ```
    Replace `.frame(width: 50, height: 50)` with `.frame(width: iconCircleSize, height: iconCircleSize)`, `.padding(16)` with `.padding(cardPadding)`.

    Add to PrimaryButton:
    ```swift
    @ScaledMetric(relativeTo: .body) private var verticalPadding: CGFloat = 18
    ```
    Replace `.padding(.vertical, 18)` with `.padding(.vertical, verticalPadding)`.
  </action>
  <verify>
    1. Zero hardcoded `.system(size:` in Components.swift: `grep -c '.system(size:' SprayCalculator/Components.swift` should output 0
    2. Zero `Color.primaryGreen` or `Color.textPrimary` etc. (old static extension syntax): `grep -c 'Color\.\(primaryGreen\|textPrimary\|textSecondary\|backgroundLight\|backgroundCard\|backgroundDark\)' SprayCalculator/Components.swift` should output 0 (use escaped literal dots)
    3. @ScaledMetric properties exist: `grep -c '@ScaledMetric' SprayCalculator/Components.swift` should be >= 8
    4. New Color(.name) syntax used: `grep -c 'Color(\.' SprayCalculator/Components.swift` should be >= 10
    5. .foregroundStyle used (not .foregroundColor): `grep -c '.foregroundStyle' SprayCalculator/Components.swift` should be >= 8 and `grep -c '.foregroundColor' SprayCalculator/Components.swift` should output 0
    6. AppGradients referenced: `grep -c 'AppGradients' SprayCalculator/Components.swift` should be >= 1
  </verify>
  <done>
    Components.swift has zero hardcoded color literals (Color.name, Color(red:green:blue:)), zero hardcoded .system(size:) font specs, uses .foregroundStyle instead of .foregroundColor throughout, has @ScaledMetric properties for all non-text dimensions (icon width, padding, circle size), and references AppGradients for gradient fills. All 5 component views are fully migrated.
  </done>
</task>

</tasks>

<verification>
1. `ls SprayCalculator/Assets.xcassets/Colors/*.colorset | wc -l` == 18
2. `grep -rn 'Color\.\(primaryGreen\|textPrimary\|textSecondary\|backgroundLight\|backgroundCard\|backgroundDark\|lightGreen\|darkGreen\|earthBrown\|lightBrown\|darkBrown\|accentGold\|waterBlue\|error\)' SprayCalculator/Components.swift` returns nothing
3. `grep -c '@ScaledMetric' SprayCalculator/Components.swift` >= 8
4. `grep -c '.foregroundColor' SprayCalculator/Components.swift` == 0
5. `grep -c '.system(size:' SprayCalculator/Components.swift` == 0
</verification>

<success_criteria>
- 18 Asset Catalog color sets created with light + dark variants
- AppGradients.swift provides 3 adaptive gradients using Color(.name) syntax
- Components.swift fully migrated: Color(.name) syntax, semantic fonts, @ScaledMetric, .foregroundStyle
- Zero old-style Color.extensionName references in Components.swift
- All files registered in Xcode project
</success_criteria>

<output>
After completion, create `.planning/phases/02-visual-polish/02-01-SUMMARY.md`
</output>
